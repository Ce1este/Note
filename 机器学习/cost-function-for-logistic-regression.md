# Cost Function for Logistic Regression

We cannot use the same cost function that we use for linear regression because the Logistic Function will cause the output to be wavy, 
causing many **local optima**. 

In other words, it will not be a **convex function**.

![convex function](../img/convex%20function.png)

Instead, our cost function for logistic regression looks like:

$\begin{array}{ll}J(\theta)=\frac{1}{m} \sum_{i=1}^{m} \operatorname{cost}\left(h_{\theta}\left(x^{(i)}\right), y^{(i)}\right) \\ \\ \operatorname{Cost}\left(h_{\theta}(x), y\right)=-\log \left(h_{\theta}(x)\right) & \text { if } \mathrm{y}=1 \\ \\ \operatorname{Cost}\left(h_{\theta}(x), y\right)=-\log \left(1-h_{\theta}(x)\right) & \text { if } \mathrm{y}=0 \end{array}$

![Cost Function for Logistic Regression](../img/Cost%20Function%20for%20Logistic%20Regression.png)


$\operatorname{cost}\left(h_{\theta}(x), y\right)=0$ if $h_{\theta}(x)=y$

$\operatorname{cost}\left(h_{\theta}(x), y\right) \rightarrow \infty$ if $y=0$ and $h_{\theta}(x) \rightarrow 1$

$\operatorname{cost}\left(h_{\theta}(x), y\right) \rightarrow \infty$ if $y=1$ and $h_{\theta}(x) \rightarrow 0$


Note that writing the cost function in this way guarantees that **J(Î¸) is convex for logistic regression**.

---
# Simplified Cost Function

We can compress our cost function's two conditional cases into one case:

$\operatorname{Cost}\left(h_{\theta}(x), y\right)=-y \log \left(h_{\theta}(x)\right)-(1-y) \log \left(1-h_{\theta}(x)\right)$

![Simplified Cost Function](../img/Simplified%20Cost%20Function.png)

A vectorized implementation is:

$h=g(X \theta)$

$J(\theta)=\frac{1}{m} \cdot\left(-y^{T} \log (h)-(1-y)^{T} \log (1-h)\right)$

---

- back to [[logistic-regression]]
- back to [[cost-function]]


[//begin]: # "Autogenerated link references for markdown compatibility"
[logistic-regression]: logistic-regression "Logistic Regression"
[cost-function]: cost-function "Cost Function"
[//end]: # "Autogenerated link references"